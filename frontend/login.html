<html>

<head>
    <meta charset="utf-8" />
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect" />
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900" onload="this.rel='stylesheet'" rel="stylesheet" />
    <title>AssisFreela - Login</title>
    <link rel="icon" href="./img/icone_raio.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#FFB300", // Amarelo AssisFreela
                        "background-light": "#F5F5F5",
                        "background-dark": "#121212",
                        "card-dark": "#1F1F1F",
                        "text-light": "#000000",
                        "text-dark": "#FFFFFF",
                    },
                    fontFamily: {
                        display: ["Montserrat", "sans-serif"],
                        body: ["Poppins", "sans-serif"],
                    },
                    borderRadius: {
                        'DEFAULT': '0.5rem',
                    },
                },
            },
        };
    </script>
    <style>
        .font-display { font-family: 'Montserrat', sans-serif; font-weight: 800; }
        .font-body { font-family: 'Poppins', sans-serif; }
    </style>
</head>

<body class="font-body">
  <div class="flex min-h-screen w-full flex-col lg:flex-row">
    
    <!-- LADO ESQUERDO (PRETO) -->
    <div class="hidden lg:flex w-1/2 items-center justify-center bg-black text-white relative overflow-hidden">
      <div class="z-10 text-center px-10">
        <div class="mb-8">
          <img src="./img/logo_reto.jpeg" alt="Logo AssisFreela" class="h-16 w-auto mx-auto">
        </div>
        <h1 class="text-3xl font-display mb-4">Conectando talentos e oportunidades.</h1>
        <p class="text-lg text-gray-400">Entre para ter visibilidade e agilidade.</p>
        <!-- <img src="./img/icone_raio.png" alt="Ícone de raio" class="h-25 w-auto mt-12 animate-pulse mx-auto"> -->
      </div>
    </div>

    <!-- LADO DIREITO (FORMULÁRIO) -->
    <div class="flex flex-col justify-center items-center w-full lg:w-1/2 bg-white dark:bg-background-dark">
      <div class="w-full max-w-md px-8 py-10">
        <h2 class="text-text-light font-display text-2xl font-bold text-center mb-6">Acesse sua conta</h2>

        <div class="space-y-4">
          <input id="login-email" type="email" placeholder="E-mail"
            class="w-full rounded-lg border border-gray-300 h-12 p-3 focus:border-primary focus:outline-none">
          <input id="login-password" type="password" placeholder="Senha"
            class="w-full rounded-lg border border-gray-300 h-12 p-3 focus:border-primary focus:outline-none">
        </div>

        <p id="login-error" class="text-red-600 text-sm text-center mt-3"></p>

        <button id="login-button"
          class="w-full bg-primary text-black font-bold rounded-lg h-10 mt-5 hover:bg-yellow-600 transition">
          Entrar
        </button>

        <!-- ESQUECI MINHA SENHA -->
<a href="esqueci-senha.html"
   class="block text-primary text-sm font-normal leading-normal pb-3 pt-1 px-4 text-center hover:underline cursor-pointer">
  Esqueci minha senha
</a>

<!-- CRIAR CONTA -->
<a href="cadastro.html"
   class="flex items-center justify-center w-full h-10 rounded-lg bg-gray-200 text-text-light text-sm font-bold leading-normal hover:bg-gray-300 transition-colors text-center mb-3">
  Criar conta
</a>

<!-- BOTÕES GOOGLE E FACEBOOK -->
<div class="flex gap-3 w-full justify-center">
  <a href="https://accounts.google.com/signup"
     class="flex-1 flex items-center justify-center h-10 rounded-lg bg-gray-200 text-text-light text-sm font-bold hover:bg-gray-300 transition-colors text-center">
    Continuar com Google
  </a>
  <a href="https://www.facebook.com/"
     class="flex-1 flex items-center justify-center h-10 rounded-lg bg-gray-200 text-text-light text-sm font-bold hover:bg-gray-300 transition-colors text-center">
    Continuar com Facebook
  </a>
</div>

<!-- RODAPÉ -->
<footer class="flex justify-center border-t border-solid border-t-gray-200 mt-6 pt-4">
  <div class="flex flex-col items-center text-center text-gray-500 text-sm">
    <a href="index.html" class="hover:underline">© 2025 AssisFreela. Todos os direitos reservados.</a>
    <div class="flex justify-center space-x-4 mt-1">
      <a href="termos.html" class="hover:underline">Termos de Uso</a>
      <a href="privacidade.html" class="hover:underline">Política de Privacidade</a>
    </div>
  </div>
</footer>


  </div>
</body>

   <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginButton = document.getElementById('login-button');
            const emailInput = document.getElementById('login-email');
            const passwordInput = document.getElementById('login-password');
            const errorElement = document.getElementById('login-error');

            loginButton.addEventListener('click', async () => {
                const email = emailInput.value;
                const password = passwordInput.value;
                errorElement.textContent = '';

                try {
                    const response = await fetch('http://127.0.0.1:8000/login', { 
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email: email, password: password })
                    });

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.detail || 'Erro ao tentar logar.');
                    }
                    
                    // SUCESSO!
                    alert(`Login bem-sucedido! Bem-vindo, ${data.username}!`);

                    // ******** A GRANDE MUDANÇA ESTÁ AQUI ********
                    // Em vez de salvar role/username, salvamos o TOKEN
                    localStorage.setItem('accessToken', data.access_token); 
                    // Opcional: Ainda podemos salvar username/role para acesso rápido, se quiser
                    localStorage.setItem('username', data.username);
                    localStorage.setItem('userRole', data.role);
                    localStorage.setItem('email', emailInput.value);
                    // ***********************************************

                    // O redirecionamento continua o mesmo, usando o 'data.role' que a API ainda retorna
                    if (data.role === 'ADMIN') {
                        window.location.href = 'Pagina_ADM/dashboard_admin.html'; 
                    } else if (data.role === 'CONTRATANTE') {
                        window.location.href = 'Pagina_Contratante/Perfil_Empresa.html'; 
                    } else if (data.role === 'FREELANCER') {
                        window.location.href = 'Pagina_Freelancer/Perfil_Freelancer.html'; // Mudei para o perfil!
                    }

                } catch (error) {
                    console.error('Erro no login:', error);
                    errorElement.textContent = error.message;
                }
            });
        });
    </script>
</body>
</html>
